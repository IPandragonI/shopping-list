import"./style-Bmac666u.js";const m=document.getElementById("recherche"),p=document.getElementById("liste-produits"),g=document.getElementById("compteur-produits"),b=document.getElementById("tri"),L=document.getElementById("reset-filtres"),l=window.localStorage,y=async()=>{try{return await(await fetch("/products-list.json")).json()}catch(t){return console.error("Error fetching products:",t),[]}},E=(t,n)=>{var a;const e=document.createElement("li");e.classList.add("card","shadow-sm","p-6","mb-5","bg-white","rounded-xl","hover:shadow-lg","transition-shadow","duration-300");const o=((a=n.find(h=>h.nom===t.nom))==null?void 0:a.quantite)||0,r=t.quantite_stock-o,i=document.createElement("h2"),c=document.createElement("p"),d=document.createElement("p"),s=document.createElement("button");return i.innerHTML=`<h2 class="card-title product-name my-1 text-xl">${t.nom}</h2>`,c.innerHTML=`<p class="my-1"><strong>Quantité : </strong>${r}</p>`,d.innerHTML=`<p class="my-1 product-price"><strong>Prix : </strong>${t.prix_unitaire}€</p>`,s.innerHTML=`<button type="button" class="btn btn-secondary mt-5" data-id="${t.nom}">Ajouter à la liste</button>`,r===0&&(e.classList.add("opacity-75"),s.disabled=!0,s.innerHTML='<button type="button" class="btn btn-secondary mt-5" data-id="${product.nom}" disabled>Produit épuisé</button>'),s.addEventListener("click",()=>f(t,s,c,e)),e.appendChild(i),e.appendChild(c),e.appendChild(d),e.appendChild(s),e},u=t=>{const n=JSON.parse(l.getItem("list"))||[];p.innerHTML="",g.innerHTML=`<p class="text-center">${t.length} produits</p>`,t.forEach(e=>{const o=E(e,n);p.appendChild(o)})},f=(t,n,e,o)=>{var s;const r=JSON.parse(l.getItem("list"))||[],i=r.find(a=>a.nom===t.nom);debugger;i?i.quantite=Math.min(t.quantite_stock,(i.quantite||0)+1):r.push({...t,quantite:1}),l.setItem("list",JSON.stringify(r)),n.innerHTML='<button type="button" class="btn btn-active btn-primary mt-5" data-id="${product.nom}">Produit ajouté !</button>',setTimeout(()=>{n.innerHTML=`<button type="button" class="btn btn-secondary mt-5" data-id="${t.nom}">Ajouter à la liste</button>`},500);const c=((s=r.find(a=>a.nom===t.nom))==null?void 0:s.quantite)||0,d=t.quantite_stock-c;e.innerHTML=`<p class="my-1"><strong>Quantité : </strong>${d}</p>`,d===0&&(o.classList.add("opacity-75"),n.disabled=!0,n.innerHTML='<button type="button" class="btn btn-secondary mt-5" data-id="${product.nom}" disabled>Produit épuisé</button>')},T=(t,n)=>t.filter(e=>e.nom.toLowerCase().includes(n.toLowerCase())),q=(t,n)=>t.slice().sort((e,o)=>n==="nom"?e.nom.localeCompare(o.nom):n==="prix"?e.prix_unitaire-o.prix_unitaire:0),M=async()=>{let t=await y();u(t),m.addEventListener("input",n=>{const e=n.target.value,o=T(t,e);u(o)}),b.addEventListener("change",n=>{const e=n.target.value,o=q(t,e);u(o)}),L.addEventListener("click",async()=>{m.value="",b.value="",t=await y(),u(t)})};document.addEventListener("DOMContentLoaded",M);
