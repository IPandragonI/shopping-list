import"./style-Bmac666u.js";const m=document.getElementById("recherche"),p=document.getElementById("liste-produits"),g=document.getElementById("compteur-produits"),b=document.getElementById("tri"),L=document.getElementById("reset-filtres"),l=window.localStorage,y=async()=>{try{return console.log("/shopping-list/"),await(await fetch("/shopping-list//products-list.json")).json()}catch(t){return console.error("Error fetching products:",t),[]}},E=(t,e)=>{var a;const n=document.createElement("li");n.classList.add("card","shadow-sm","p-6","mb-5","bg-white","rounded-xl","hover:shadow-lg","transition-shadow","duration-300");const o=((a=e.find(h=>h.nom===t.nom))==null?void 0:a.quantite)||0,r=t.quantite_stock-o,i=document.createElement("h2"),c=document.createElement("p"),d=document.createElement("p"),s=document.createElement("button");return i.innerHTML=`<h2 class="card-title product-name my-1 text-xl">${t.nom}</h2>`,c.innerHTML=`<p class="my-1"><strong>Quantité : </strong>${r}</p>`,d.innerHTML=`<p class="my-1 product-price"><strong>Prix : </strong>${t.prix_unitaire}€</p>`,s.innerHTML=`<button type="button" class="btn btn-secondary mt-5" data-id="${t.nom}">Ajouter à la liste</button>`,r===0&&(n.classList.add("opacity-75"),s.disabled=!0,s.innerHTML='<button type="button" class="btn btn-secondary mt-5" data-id="${product.nom}" disabled>Produit épuisé</button>'),s.addEventListener("click",()=>f(t,s,c,n)),n.appendChild(i),n.appendChild(c),n.appendChild(d),n.appendChild(s),n},u=t=>{const e=JSON.parse(l.getItem("list"))||[];p.innerHTML="",g.innerHTML=`<p class="text-center">${t.length} produits</p>`,t.forEach(n=>{const o=E(n,e);p.appendChild(o)})},f=(t,e,n,o)=>{var s;const r=JSON.parse(l.getItem("list"))||[],i=r.find(a=>a.nom===t.nom);i?i.quantite=parseInt(i.quantite)+1:r.push({...t,quantite:1}),l.setItem("list",JSON.stringify(r)),e.innerHTML='<button type="button" class="btn btn-active btn-primary mt-5" data-id="${product.nom}">Produit ajouté !</button>',setTimeout(()=>{e.innerHTML=`<button type="button" class="btn btn-secondary mt-5" data-id="${t.nom}">Ajouter à la liste</button>`},500);const c=((s=r.find(a=>a.nom===t.nom))==null?void 0:s.quantite)||0,d=t.quantite_stock-c;n.innerHTML=`<p class="my-1"><strong>Quantité : </strong>${d}</p>`,d===0&&(o.classList.add("opacity-75"),e.disabled=!0,e.innerHTML='<button type="button" class="btn btn-secondary mt-5" data-id="${product.nom}" disabled>Produit épuisé</button>')},T=(t,e)=>t.filter(n=>n.nom.toLowerCase().includes(e.toLowerCase())),q=(t,e)=>t.slice().sort((n,o)=>e==="nom"?n.nom.localeCompare(o.nom):e==="prix"?n.prix_unitaire-o.prix_unitaire:0),w=async()=>{let t=await y();u(t),m.addEventListener("input",e=>{const n=e.target.value,o=T(t,n);u(o)}),b.addEventListener("change",e=>{const n=e.target.value,o=q(t,n);u(o)}),L.addEventListener("click",async()=>{m.value="",b.value="",t=await y(),u(t)})};document.addEventListener("DOMContentLoaded",w);
